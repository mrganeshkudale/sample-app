on: [push]

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@main
    - uses: azure/k8s-set-context@v1
      with:
        method: service-account
        k8s-url: https://atos-tra-pla-cluster-dns-d22f6440.hcp.eastus.azmk8s.io:443
        k8s-secret: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUV5akNDQXJLZ0F3SUJBZ0lSQUpwaXgxZDh2S0crWTFSWXZ4TFZsLzB3RFFZSktvWklodmNOQVFFTEJRQXcKRFRFTE1Ba0dBMVVFQXhNQ1kyRXdJQmNOTWpBeE1qQXhNVFExTmpVMldoZ1BNakExTURFeU1ERXhOVEEyTlRaYQpNQTB4Q3pBSkJnTlZCQU1UQW1OaE1JSUNJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBZzhBTUlJQ0NnS0NBZ0VBCnA3RTVPNDlsbHR1TTJWVXhtSVJrWE1DeHNYMzlwemkxdGlmSmNMV2JpZVdQOUpXK2ppV1VqNVFYMzRmOUJXcCsKNEN3aUFVZm0yQkVVUm1WdmViUnBFMi9VNmFLU3RrdEtwM2ZkOVBPa0xWSGRKT2d0Y3pQbldHNkY5M1VwL0dwegpOcUZkcEw2WldsWExiNmVEZTU2TmxZc1EvSDdHeFlxaWc1VEVma3VKc01KZDR2aHhmeWI4YjhnWS9YVTNaeGNSCnlzTlVOUmIxZDVZT2NKdkJYbTdwUEdzUHZRY3Z4U1h5RmQyR05pYlVtb1QyTHFuWWJtek01dVhiOG5jTUo2dncKK2tudTdxR3B0dG5SSFFjc1QwUzMzbnlqNjJ4NnlyY25SMGhaZzRTUk92Z3RwMW9yUzRoMnMyZVl2L1JOVzlSdwphekNHbE9nRTUyR1VuUmtsT3BvZCtyZlRLUmV6N1M2V1ZMTGJ1THkvNDVMSHZEMFptL3VPd3BtUTZTS1lxbnBZCjNISTFTTlkxQ2xOTEJGSndmM2dQTThGZ29GRzY4QmlCYitDVERPYzBiVFcwQzVqbVNuNGw0eU5MK01ZZklDNDAKT0NJV2JuTXhteUFubGV4NUFkU0JNdE1zVnhtUjZ2VVc2cUlWUlo0aWxYdnpkZDRlaG5ZNGFEUi9CVjkvVlFVMQpVdmFpUUFjcU95TGRQd2ZpVVVKVTdQWUM2VFRvdDVWSDJ3OG1paUJPY2VLQUdsMkxYR0ZHUEV4NThlQ3U3cFVDCmt5U0NMeDM0UW50T1U5elR3ek9JaS9MMDhhTmt5R0JSTjB4Mkt1VnFibTBVbFMrVUVqYUY4LzVoUE5jaWtuRFUKaVlaV01nQ2xpREtxaXdMbjYrbk1qMUE4c3ZjbTMzd1gyTWpMTG5Gd24xc0NBd0VBQWFNak1DRXdEZ1lEVlIwUApBUUgvQkFRREFnS2tNQThHQTFVZEV3RUIvd1FGTUFNQkFmOHdEUVlKS29aSWh2Y05BUUVMQlFBRGdnSUJBQkJqCjB4UVhCdml4L3pVZFRvYVlRK3M4U1J6c3FXK3gyYngyUk1uUXluMlBYaU0yR3ZCeXBCeFF5bUgxSFNvdHBwUzQKNTBGdldPcUFmblZkN01QbWhWR1JkdXhwaVRGUjc0ejlIbjJqSWNOd3VFNnZFOWtMSXFiTFlDbkZpTWsyamt5MwpVS3VnWE9OYSt3eTFDTktVSGY5TERCNDY4c2VMWE1PczVRVDZZc1ExUkRGZVZSNUJlb1IvTlljNDZxZWFPaE5XCmd0R2g1aHpwWjZhNC96SUdoa2NPUDlEQTZrRUU3alk1ZUpXMjNnbGhtSGJ2eFZTbExnUU5xcmpNWUZDc21ZU3UKa2NHQkUwTEhRSVZOblI3UCtJMlpYMFRwaENucXVpYzdVVzJteFJFZkFPWkY4V2pKVHJYSzJycWdQME5xWFVqbwpHY0N0bkljaTBDVVBoUU1Odk9YTzAzYzZpY2NkK2lacktMSE10Vkc3OU9RbkFjV3F6RDcyVC80L0pEeTUrbEwxCm5rUFBjZ2FrQUJDcWYwS2I3SmNlUmtxOVZRckx0V0ZuaXNwYUxFMzdLOWZjYUFiNXYzRWhXZUdoaXp4bnlxdXoKZlkxaVFCU1dWMXY0eHRINlczR1hVcHNISXlmR0k4M091WXowWTNKL1VtZmx1Q0JTVkU1bHZOVXdFWThtWnh3VApPSHY5MUJ1Uk5HZk1RZEJXS3A3a2tjaFF0alJFUE1CcEFzT0duWXk4Z3BPZkJjMkxUOUpVNEllMFlneGYrMkUyCml0b1J6cDBiSWNJb1FHak9RQW0yY3ZqcStiMGQ2QTlDQk5WNldsc05TdFhhcHI4VEZyRTBIRUtuNEtsdHE0WnYKS2RLeGNWbzRGQ215WFJ4aHVlWVdYVlRYc2tTU3ZZbmloRXZ3bDV4RAotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
      id: setcontext
    - uses: Azure/k8s-deploy@v1.4
      with:
        namespace: 'dev'
        manifests: |
            dev.yaml
